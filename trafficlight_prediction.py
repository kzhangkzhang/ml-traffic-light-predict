# -*- coding: utf-8 -*-
"""TrafficLight_Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1yGrvKzVX8g1bUlTnVDSIWKek1Wk2Ihoa

# Learning Neural Network from Youtube

  Date             : 15-Nov-2018
  
  Description: Predict Traffic Light
  
  Python       : Python 3

[# Youtube Source](https://www.youtube.com/watch?v=u7n9t1cBei8)
"""

import numpy as np

weights = np.array([0.7, 0.2, -0.5]) # the value need be -1 ~ +1
alpha = 0.1                          # it helps to make sure your neural network under the control

# 1: signal is on; 0: signal is off
streetlights = np.array([               
                         [1, 0, 1],      
                         [0, 1, 1],
                         [0, 0, 1],
                         [1, 1, 1],
                         [0, 1, 1],
                         [1, 0, 1]
                        ])

# 0: Stop, 1: Walk
walk_vs_stop = np.array([0, 1, 0, 1, 1, 0]) 

for iteration in range(40):
  error_for_all_lights = 0
  for row_index in range(len(walk_vs_stop)):
    input = streetlights[row_index]
    goal_prediction = walk_vs_stop[row_index]
    
    prediction = input.dot(weights)
    error = (prediction - goal_prediction) ** 2
    error_for_all_lights += error
    
    delta = prediction - goal_prediction
    weights = weights - (alpha * (input * delta))
    
    print("Prediction:" + str(prediction))
    
  print("Weights:" + str(weights))
  print("Error:" + str(error))

